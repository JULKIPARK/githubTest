<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{backoffice/layout/defaultLayout}">

<!-- popup Fragment -->
<th:block th:fragment="framentBySrcSearchPop">
  <script type="text/javascript">
    $.fn.clearForm = function () {
      return this.each(function () {
        var type = this.type,
            tag = this.tagName.toLowerCase();
        if (tag === "form") {
          return $(":input", this).clearForm();
        }
        if (
            type === "text" ||
            type === "password" ||
            type === "hidden" ||
            tag === "textarea"
        ) {
          this.value = "";
        } else if (type === "checkbox" || type === "radio") {
          this.checked = false;
        } else if (tag === "select") {
          this.selectedIndex = -1;
        }
      });
    };

    // On Load
    $(function () {
      // function initializeFormBySrcSearchPop() {
      //   $("#frmBySrcSearchPop").clearForm();
      // }

      fnInitEventsBySrcSearchPop();
    });

    function fnInitEventsBySrcSearchPop() {
      $('#btnSearchBySrcSearchPop').bind('click', function() {
        fnShowBySrcSearchPop();
      });
      $('#btnCloseBySrcSearchPop').bind('click', function() {
        $('#mainBySrcSearchPop').removeClass('show');
      });

      // srcUpsertPop -> Initialize Event.
      // initializePopupEvents();
    }

    function fnShowBySrcSearchPop() {
      var formData, param = {};
      formData = _formLib.getFormData("frmBySrcSearchPop");

      var param = {
        "url": "/sems/contents/selectSrcSearchPopView"
        , "type": "post"
        , "data": formData
        , "async": false
        , "callback": function (fragment) {
          $("#divSrcSearchPopList").replaceWith(fragment);
          // $("#totalCountSrcSearchPopView").text("총 "+ _formLib.addComma($("#totalCountSrcSearchPop").val()) + "건");

          //페이징처리
          var currPage = $('#optPageNumSrcSearchPop').val();//현재 선택된 페이지
          $('#optPageNumSrcSearchPop').empty();//페이지 option 삭제
          for (var count = 1; count <= $("#totalPageSrcSearchPop").val(); count++) {
            var selTxt = "";
            if (count == currPage) {
              selTxt = "selected='selected'";//현재 페이지 선택
            }

            var option = $("<option value='" + count + "' " + selTxt + ">" + count + "/" + $(
                "#totalPageSrcSearchPop").val() + "</option>");
            $('#optPageNumSrcSearchPop').append(option);
          }
        }
      };
      _comLib.callAjax(param);

      $("#mainBySrcSearchPop").css("zIndex", 901);
      $('#mainBySrcSearchPop').addClass('show');
      $('.dimmed').removeAttr('style');
    }

		// 출처 정보 적용하기
		function fnApply(params) {
      // 팝업을 호출한 모 창에 아래 함수가 있어야 한다!!
      fnApplyData(params);

			$('#mainBySrcSearchPop').removeClass('show');
		}

  </script>

  <!-- modal-wrap -->
  <div id="mainBySrcSearchPop" class="modal-wrap"><!-- class="show" 제거시 비노출 default가 hidden 처리 -->
    <div class="dimmed"></div>
    <div class="xycenter">
      <section class="modal-area small">
        <div class="modal-head">
          <h2 class="tit">출처 검색</h2>
          <button type="button" class="btn-close bf"><span class="blind">닫기</span></button>
        </div>
        <section class="modal-cont">
          <div class="form-content">
            <form id="frmBySrcSearchPop">
              <fieldset>
                <legend>출처 검색</legend>
                <div class="search-wrap">
                  <div class="table-wrap">
                    <table class="inner-input align-left">
                      <caption>출처 검색</caption>
                      <colgroup>
                        <col style="width: 30%;">
                        <col style="width: *;">
                      </colgroup>
                      <tbody>
                      <tr>
                        <th>출처명</th>
                        <td>
                          <div class="selectinput-wrap">
                            <select name="schSrcOptBySrcSearchPop" id="schSrcOptBySrcSearchPop" class="select" title="출처명/번호선택">
                              <option value="01">출처명</option>
                              <option value="02">출처번호</option>
                            </select>
                            <input type="text" name="schSrcWrdBySrcSearchPop" id="schSrcWrdBySrcSearchPop" placeholder="" title="입력">
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <th>국내/해외</th>
                        <td>
                          <ul class="flex ck-list">
                            <li>
                              <input type="radio" name="schDmstcChkBySrcSearchPop" value="ALL" id="area04">
                              <label for="area04">전체</label>
                            </li>
                            <li>
                              <input type="radio" name="schDmstcChkBySrcSearchPop" value="Y" id="area05">
                              <label for="area05">국내</label>
                            </li>
                            <li>
                              <input type="radio" name="schDmstcChkBySrcSearchPop" value="N" id="area06">
                              <label for="area06">해외</label>
                            </li>
                          </ul>
                        </td>
                      </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <!-- //table-wrap -->
                <div class="btn-wrap">
                  <button type="button" id="btnSearchBySrcSearchPop" class="btn-primary">검색</button>
                  <button type="button" onclick="fnShowBySrcUpsertPop('');" class="btn-sub">신규 출처 추가</button>
                </div>
                <!-- //btn-wrap -->
                <div class="result-wrap">
                  <div class="sorting-wrap">
                    <select name="optPageSizeSrcSearchPop" id="optPageSizeSrcSearchPop"
                            class="select" title="데이터 건수">
                      <option value="20">20개</option>
                      <option value="50">50개</option>
                      <option value="100" selected="selected">100개</option>
                      <option value="500">500개</option>
                      <option value="1000">1000개</option>
                    </select>
                    <select name="optPageNumSrcSearchPop" id="optPageNumSrcSearchPop" class="select"
                            title="페이지 이동선택">
                    </select>
                  </div>
                  <!-- //sorting-wrap -->
                  <div id="divSrcSearchPopList" class="table-wrap ">
                    <!-- 페이징 정보 -->
                    <th:block th:unless="${#lists.isEmpty(list)}">
                      <input type="hidden" id="totalCountSrcSearchPop"
                             th:value="${PageInfo.totalCount}"/>
                      <input type="hidden" id="pageNumberSrcSearchPop"
                             th:value="${PageInfo.pageNumber}"/>
                      <input type="hidden" id="totalPageSrcSearchPop"
                             th:value="${PageInfo.totalPage}"/>
                    </th:block>
                    <table>
                      <caption>출처 검색 리스트</caption>
                      <colgroup>
                        <col style="width: 10%;">
                        <col style="width: 25%;">
                        <col style="width: *;">
                        <col style="width: 20%;">
                      </colgroup>
                      <thead>
                      <tr>
                        <th>NO</th>
                        <th>출처번호</th>
                        <th>출처명</th>
                        <th>국내/해외</th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr th:each="item, stat : ${list}">
                        <td th:text="${stat.count}">1</td>
                        <td><a th:text="${item.srcUno}"
                               th:onclick="fnApply([[|${item.srcUid},${item.srcNm},${item.dmstcYn},${item.dmstcYnNm}|]]);"
                               class="link">SK12345</a></td>
                        <td th:text="${item.srcNm}" class="left">삼일회계법인</td>
                        <td th:text="${item.dmstcYnNm}">국내</td>
                      </tr>
                      <tr th:if="${#lists.isEmpty(list)}">
                        <td class="nodata" colspan="4">데이터가 존재하지 않습니다.</td>
                      </tr>
                      </tbody>
                    </table>
                  </div>
                  <!-- //table-wrap -->
                </div>
                <!-- //result-list -->
                <div class="btn-wrap">
                  <button type="button" id="btnCloseBySrcSearchPop" class="btn-sub btn-close">닫기</button>
                </div>
                <!-- //btn-wrap -->
              </fieldset>
            </form>
          </div>
          <!-- form-content -->
        </section>
        <!--//modal-cont-->
      </section>
      <!--//modal-area-->
    </div>
    <!-- //xycenter -->
  </div>
  <!--//modal-wrap-->

  <!-- 출처등록 popup fragment-->
  <th:block th:replace="/sems/contents/contentInfo/srcUpsertPop :: fragmentBySrcUpsertPop"></th:block>

</th:block>
</html>
